# Common Mistakes in AI Development

## 1. 概述

本文件記錄了在開發 AI 代理程式（尤其是基於 LLM 的代理程式）時常見的錯誤和陷阱。在開發過程中參考此文件，可以幫助我們避免重蹈覆轍，提高開發效率和系統穩定性。

**目標讀者**: 所有參與此專案的開發者和 AI 代理程式。

## 2. LLM 與提示工程相關錯誤

### 2.1 錯誤：過於信任 LLM 的輸出
- **問題描述**: 盲目相信 LLM 生成的程式碼、文字或決策，未經審查直接使用，可能導致事實錯誤、安全漏洞或邏輯謬誤（即 "幻覺"）。
- **解決方案**:
    - **人機協作**: 所有關鍵的 LLM 輸出（如程式碼、問題報告、API 呼叫參數）都必須經過人類審查或自動化驗證。
    - **RAG (檢索增強生成)**: 優先使用從可靠來源（如專案程式碼庫）檢索到的資訊作為上下文，而不是依賴模型的內部知識。
    - **結構化輸出**: 強制 LLM 輸出結構化資料（如 JSON），並使用 Pydantic 等工具進行驗證，確保格式和類型的正確性。

### 2.2 錯誤：提示不明確或缺乏上下文
- **問題描述**: 模糊的提示會導致 LLM 產生不相關或不可預測的結果。
- **解決方案**:
    - **明確指令**: 使用清晰、無歧義的語言。
    - **角色扮演**: 在提示開頭明確設定 LLM 的角色和目標。
    - **提供範例 (Few-shot Learning)**: 在提示中提供一兩個期望的輸入/輸出範例。
    - **上下文注入**: 將所有相關資訊（如用戶查詢、相關程式碼、歷史對話）清晰地注入到提示中。

## 3. 系統架構與設計相關錯誤

### 3.1 錯誤：將所有邏輯都放在一個代理程式中
- **問題描述**: 建立一個試圖處理所有事情的單體式 (Monolithic) AI 代理程式，導致系統難以維護、擴展和除錯。
- **解決方案**:
    - **多代理程式架構**: 將複雜任務分解，由多個專業代理程式協作完成（例如 `CodeAnalyzerAgent`, `ReportWriterAgent`, `GitHubToolAgent`）。
    - **工具化**: 將可重用的功能封裝成獨立的工具，供代理程式調用，而不是將邏輯寫死在代理程式內部。

### 3.2 錯誤：忽略數據的預處理和後處理
- **問題描述**: 直接將原始數據（如用戶回饋、程式碼文件）餵給 LLM，或直接使用 LLM 的原始輸出，會降低準確性和可靠性。
- **解決方案**:
    - **預處理**:
        - **程式碼**: 使用 `tree-sitter` 等工具進行解析和分割，而不是簡單的字符分割。
        - **文本**: 清理 HTML 標籤、移除無關資訊、提取關鍵實體。
    - **後處理**:
        - **驗證**: 驗證 LLM 輸出的格式和內容。
        - **修復**: 設計簡單的規則來修復常見的 LLM 輸出錯誤（如 JSON 格式不完整）。

## 4. 更新記錄

| 日期       | 版本 | 更新內容           | 更新人 |
|------------|------|--------------------|--------|
| 2025-07-24 | 1.0  | 初始版本建立       | Cline  |
